# INTRO-TASK-01

---

### Docker

Собственно, образ собирается без параметров в корне репозитория и пушится.

```
docker build -t moraresearch/intro-task-01 .
docker push moraresearch/intro-task-01
```

P.S. Так как задание рассчитано под кубер, подготовка хранилища вынесена в init контейнер. То есть для запуска вне кубер нужно сначала подготовить volume поменяв entrypoint.

---

### Helm 

Чарт приложения находится в папке deployments.<br/>
Для выполнения задания 1.3 я определяю тип хранилища по значению переменной окружения STORAGE_TYPE, которую можно поменять при запуске чарта.<br/>
Для выполнения задания 2.2 я не делаю ничего, так как в дефолтном деплойменте все и так указано. Cелекторы устанавливаются при запуске в словаре nodeSelector.<br/>
Для выполнения задания 2.3 при создании/обновлении чарта нужно указать переменную serviceMonitor.enabled в значении true.<br/>

```
helm install intro deployment/intro \
    --set serviceMonitor.enabled=true
    --set configmap.storageType=sqlModule
```

P.S. не шарю за serviceMonitor. для проверки поставил к себе в minikube прометей из чарта и serviceMonitor не хотел работать без label release=prometheus. Решил не добавлять это к себе в чарт потому что вряд ли это на каждом кластере так работает, но вот уточняю